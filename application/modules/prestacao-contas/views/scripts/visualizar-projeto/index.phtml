<script type="text/x-template" id="visualizar">
    <div>
        <button class="btn" v-on:click="modal()">
            {{pronac}}
        </button>
    </div>
</script>

<script type="text/x-template" id="dados">
    <div>
          <ul class="collapsible" data-collapsible="accordion">
            <li v-for="dado in dados">
              <div class="collapsible-header">{{dado.title}}</div>
              <div class="collapsible-body">
                <tabela v-bind:dados="dado"></tabela>
              </div>
            </li>
          </ul>
    </div>
</script>

<script type="text/x-template" id="tabela-vue">
    <div>
    {{dados}}
        <table class="bordered">
            <thead>
                <th v-for="cab in dados.cols">
                    {{cab}} 
                </th>
            </thead>
            <tbody>
                <tr v-for="dado in dados.lines">
                    <td v-for="d in dado">
                        {{d}}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</script>

<script type="text/javascript">
    Vue.component('visualizar', {
        template: '#visualizar',
        data: function() {
            return {
                dados:[]
            }
        },
        props: ['idpronac', 'pronac'],
        mounted: function() {
            this.dados = [{ nome: 'teste' }, { nome: 'teste1' }]
        },
        methods: {
            modal: function() {
                bus.$emit('id-selected', this.idpronac)
                $3('#abrirModal').modal();
                $3('#abrirModal').modal('open');
            }
        }
    });

    Vue.component('dados', {
        template: '#dados',
        data: function() {
            return {
                dados:[]
            }
        },
        created: function() {
            vue = this;
            bus.$on('id-selected', function (id) {
                vue.idpronac = id;
                vue.alerta();
            });
        },
        props: ['idpronac'],
        mounted: function() {
        },
        methods: {
            alerta: function() {
                vue = this;
                $3.ajax({
                    url: '/prestacao-contas/visualizar-projeto/dados-projeto?idPronac=' + vue.idpronac
                })
                .done( function(data) {
                    vue.dados = data; 
                });
            }
        }
    });

    Vue.component('tabela', {
        template: '#tabela-vue',
        data: function() {
            return {
                dados:[]
            }
        },
        props: ['dados'],
        mounted: function() {
        },
        methods: {
            alerta: function() {
            }
        }
    });

    var bus = new Vue({});

    var app = new Vue({
        el: '#container'
    });

</script>
<style>
  #abrirModal.modal{
       height: 90%;
       max-height: 96%;
       width: 98%;
    }
</style>
<!-- Modal Structure -->
