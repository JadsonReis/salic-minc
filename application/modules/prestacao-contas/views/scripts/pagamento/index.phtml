<!--<div id="app" class="container-fluid">-->
<!--    <v-app>-->
<!--        <v-content>-->
<!--            <page-title></page-title>-->
<!--            <v-container>-->
<!--                <router-view></router-view>-->
<!--            </v-container>-->
<!--        </v-content>-->
<!--    </v-app>-->
<!--</div>-->

<div class="row" id="app">
    <div class="col s12 m12">
        <div class="card">
            <div class="card-content">
                <div class="card">
                    <div class="center-align card-content grey lighten-4">
                        <span class="card-title">PLANILHA DE ORÇAMENTO APROVADA</span>
                    </div>
                    <dados idpronac="<?php echo $this->idpronac ?>"></dados>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- vendor -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- vendor -->

<!-- views -->
<script>
    Vue.component('produtos-pagamento', {
        props: ['itens'],
        template: `<ul class="collapsible no-margin" data-collapsible="expandable" id="produtos-collapsible">
                        <li class="active" v-for="item in itens">
                            <div class="collapsible-header green-text active">
                                <i class="material-icons">perm_media</i>
                                {{ item.produto }}
                            </div>
                            <div class="collapsible-body no-padding">
                                <ul class="collapsible no-margin no-border" data-collapsible="expandable">
                                    <etapas-pagamento :item="etapa"
                                           v-for="(etapa, index) in item.etapa"
                                           :key="index"></etapas-pagamento>
                                </ul>
                            </div>
                        </li>
                    </ul>`,
        mounted: function () {
            this.iniciarCollapsible();
        },
        methods: {
            iniciarCollapsible: function () {
                $3('#produtos-collapsible.collapsible').each(function() {
                    $3(this).collapsible();
                });
            }
        }
    })
    Vue.component('etapas-pagamento', {
        props: ['item'],
        template: `<li class="active">
                        <div class="collapsible-header orange-text active" style="padding-left: 30px;">
                            <i class="material-icons">label</i>
                            {{ item.etapa }}
                        </div>
                        <div class="collapsible-body no-padding">
                            <ul class="collapsible no-margin no-border" data-collapsible="expandable">
                                    <ufs-pagamento :item="UF"
                                       v-for="(UF, index) in item.UF"
                                       :key="index"></ufs-pagamento>
                            </ul>
                        </div>
                    </li>
                   `,
        mounted: function () {
            this.iniciarCollapsible();
        },
        methods: {
            iniciarCollapsible: function () {
                $3('.collapsible').each(function() {
                    $3(this).collapsible();
                    console.log(this);
                });
            }
        }
    })
    Vue.component('ufs-pagamento', {
        props: ['item'],
        template: ` <li class="active">
                        <div class="collapsible-header blue-text active" style="padding-left: 50px;">
                            <i class="material-icons">place</i>
                            {{ item.Uf }}
                        </div>
                        <div class="collapsible-body no-padding">
                            <ul class="collapsible no-margin no-border" data-collapsible="expandable">
                                    <cidades-pagamento :item="cidade"
                                       v-for="(cidade, index) in item.cidade"
                                       :key="index"></cidades-pagamento>
                            </ul>
                        </div>
                    </li>
                     `,
        methods: {
            iniciarCollapsible: function () {
                $3('.collapsible').each(function() {
                    $3(this).collapsible();
                    console.log(this);
                });
            }
        }
    })
    Vue.component('cidades-pagamento', {
        props: ['item'],
        template: ` <li class="active">
                        <div class="collapsible-header blue-text active" style="padding-left: 70px;">
                            <i class="material-icons">place</i>
                            {{ item.cidade }}
                        </div>
                        <div class="collapsible-body no-padding margin20 scroll-x">
                            <table class="bordered">
                                <thead>
                                    <tr>
                                        <th>Item de Custo</th>
                                        <th>Valor Aprovado</th>
                                        <th>Valor Comprovado</th>
                                        <th>Valor a Comprovar</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr :item="item"
                                       v-for="(item, index) in item.item"
                                       :key="index"
                                       v-if="isObject(item)">
                                        <td>
                                            {{ item.item }}
                                        </td>
                                        <td> R$ {{ item.varlorAprovado }} </td>
                                        <td> R$ {{ item.varlorComprovado }} </td>
                                        <td> R$ {{ item.comprovacaoValidada }} </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </li>
                     `,
        methods: {
            iniciarCollapsible: function () {
                $3('.collapsible').each(function() {
                    $3(this).collapsible();
                    console.log(this);
                });
            },
            isObject: function (el) {

                return typeof el === "object";

            },
            converterParaReal: function (value) {
                value = parseFloat(value);
                return numeral(value).format('0,0.00');
            }
        }
    })
    Vue.component('dados', {
        props: ['idpronac'],
        template: `<div>
                            <produtos-pagamento :itens="produtos"></produtos-pagamento>
                    </div>`,
        created: function () {
                // this.iniciarCollapsible();
        },
        mounted: function () {
            let vue = this;
            $3.ajax({
                url: "/prestacao-contas/pagamento/planilha-pagamento/idpronac/" + this.idpronac
            }).done(function( data ) {
                    vue.$data.produtos = data;
                });
        },
        data: function () {
            return {
                produtos: []
            };
        },
        methods: {
            iniciarCollapsible: function () {
                $3('.collapsible').each(function() {
                    $3(this).collapsible();
                    console.log(this);
                });
            }
        }

    })

    var app = new Vue({
        el: '#app',
        methods: {
            iniciarCollapsible: function () {
                $3('.collapsible').each(function () {
                    $3(this).collapsible();
                    console.log(this);
                });
            }
        }
    })

</script>
<!-- views -->